<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Configuring and building &#8212; Flint 2.9.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    
    <script src="_static/documentation_options.js?v=182a64a0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <script src="_static/sidebar.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bug reporting" href="bug_reporting.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="bug_reporting.html" title="Bug reporting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Flint 2.9.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><strong>Configuring and building</strong></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="configuring-and-building">
<span id="building"></span><h1><strong>Configuring and building</strong><a class="headerlink" href="#configuring-and-building" title="Link to this heading">¶</a></h1>
<section id="configuring-flint">
<h2>Configuring Flint<a class="headerlink" href="#configuring-flint" title="Link to this heading">¶</a></h2>
<p>There are three ways to build Flint. One way is through a standard set of CMake
files provided in the distribution. A second way is with a custom build
system based on a configuration script and Makefiles also provided in the
distribution. A third way using MSVC solution files is documented in a section
further down.</p>
<p>The easiest way to use FLINT is to build a shared library. Simply download
the FLINT tarball and untar it on your system.</p>
<p>FLINT requires either MPIR (version 2.6.0 or later) or GMP (version 5.1.1 or
later). If MPIR is used, MPIR must be built with the <code class="docutils literal notranslate"><span class="pre">--enable-gmpcompat</span></code>
option. FLINT also requires MPFR 3.0.0 or later and a pthread implementation.</p>
<p>Some of the input/output tests require <code class="docutils literal notranslate"><span class="pre">fork</span></code> and <code class="docutils literal notranslate"><span class="pre">pipe</span></code>, however
these are disabled on Windows when a posix implementation is not provided.</p>
<p>If it happens that GMP/MPIR and MPFR are not in a standard location on your
system (e.g. not in <code class="docutils literal notranslate"><span class="pre">/usr/include/</span></code> and <code class="docutils literal notranslate"><span class="pre">/usr/lib/</span></code>), you need to tell the
configure script where they are with the options <code class="docutils literal notranslate"><span class="pre">--with-gmp=/path/to/gmp</span></code>
or <code class="docutils literal notranslate"><span class="pre">--with-mpir=/path/to/mpir</span></code> and <code class="docutils literal notranslate"><span class="pre">--with-mpfr=/path/to/mpfr</span></code>, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./configure<span class="w"> </span>--with-gmp<span class="o">=</span>/home/user1/local<span class="w"> </span>--with-mpfr<span class="o">=</span>/home/user1/local
</pre></div>
</div>
<p>FLINT can also build against a source build of GMP/MPIR and MPFR. Though
programs using FLINT may require GMP/MPIR and MPFR to be installed (via
<code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> if built from sources).</p>
<p>Note that FLINT builds static and shared libraries by default, except on
platforms where this is not supported. If you do not require either a shared
or static library then you may pass <code class="docutils literal notranslate"><span class="pre">--disable-static</span></code> or
<code class="docutils literal notranslate"><span class="pre">--disable-shared</span></code> to <code class="docutils literal notranslate"><span class="pre">configure</span></code>. This can substantially speed up the
build.</p>
<p>If you intend to install the FLINT library and header files, you can specify
where they should be placed by passing <code class="docutils literal notranslate"><span class="pre">--prefix=path</span></code> to configure, where
<code class="docutils literal notranslate"><span class="pre">path</span></code> is the directory under which the <code class="docutils literal notranslate"><span class="pre">lib</span></code> and <code class="docutils literal notranslate"><span class="pre">include</span></code> directories
exist into which you wish to place the FLINT files when it is installed.</p>
</section>
<section id="tls-reentrancy-and-single-mode">
<h2>TLS, reentrancy and single mode<a class="headerlink" href="#tls-reentrancy-and-single-mode" title="Link to this heading">¶</a></h2>
<p>FLINT uses thread local storage by default (<code class="docutils literal notranslate"><span class="pre">--enable-tls</span></code>). However, if
reentrancy is required on systems that do not support this, one can pass
<code class="docutils literal notranslate"><span class="pre">--disable-tls</span></code> and mutexes will be used instead (requires POSIX). As most
modern systems support thread local storage, it is not recommended to build
FLINT without TLS.</p>
<p>There are two modes in which FLINT may installed: the default <code class="docutils literal notranslate"><span class="pre">single</span></code> mode,
which is faster, but makes use of thread local storage for its memory manager
and to handle threading, and a slower but less complicated <code class="docutils literal notranslate"><span class="pre">reentrant</span></code> mode.
The later is useful when debugging a program where tracing allocations is
important.</p>
<p>If you wish to select the single mode, pass the <code class="docutils literal notranslate"><span class="pre">--single</span></code> option to
configure, though note that this is the default. The reentrant mode is selected
by passing the option <code class="docutils literal notranslate"><span class="pre">--reentrant</span></code> to configure.</p>
</section>
<section id="abi-and-architecture-support">
<h2>ABI and architecture support<a class="headerlink" href="#abi-and-architecture-support" title="Link to this heading">¶</a></h2>
<p>On some systems, e.g. Sparc and some Macs, more than one ABI is available.
FLINT chooses the ABI based on the CPU type available, however its default
choice can be overridden by passing either <code class="docutils literal notranslate"><span class="pre">ABI=64</span></code> or <code class="docutils literal notranslate"><span class="pre">ABI=32</span></code> to
configure.</p>
<p>To build on MinGW64 it is necessary to pass <code class="docutils literal notranslate"><span class="pre">ABI=64</span></code> to configure, as FLINT
is otherwise unable to distinguish it from MinGW32.</p>
<p>In some cases, it is necessary to override the CPU/OS defaults. This can be
done by passing <code class="docutils literal notranslate"><span class="pre">--build=cpu-os</span></code> to configure.</p>
<p>The available choices for CPU include <code class="docutils literal notranslate"><span class="pre">x86_64</span></code>, <code class="docutils literal notranslate"><span class="pre">x86</span></code>, <code class="docutils literal notranslate"><span class="pre">ia64</span></code>, <code class="docutils literal notranslate"><span class="pre">sparc</span></code>,
<code class="docutils literal notranslate"><span class="pre">sparc64</span></code>, <code class="docutils literal notranslate"><span class="pre">ppc</span></code>, <code class="docutils literal notranslate"><span class="pre">ppc64</span></code>. Other CPU types are unrecognised and FLINT
will build with generic code on those machines.</p>
<p>The choices for OS include <code class="docutils literal notranslate"><span class="pre">Linux</span></code>, <code class="docutils literal notranslate"><span class="pre">MINGW32</span></code>, <code class="docutils literal notranslate"><span class="pre">MINGW64</span></code>, <code class="docutils literal notranslate"><span class="pre">CYGWIN32</span></code>,
<code class="docutils literal notranslate"><span class="pre">CYGWIN64</span></code>, <code class="docutils literal notranslate"><span class="pre">Darwin</span></code>, <code class="docutils literal notranslate"><span class="pre">FreeBSD</span></code>, <code class="docutils literal notranslate"><span class="pre">SunOS</span></code> and numerous other operating
systems.</p>
<p>It is also possible to override the default CC, AR and CFLAGS used by FLINT by
passing <code class="docutils literal notranslate"><span class="pre">CC=full_path_to_compiler</span></code>, etc., to FLINT’s configure.</p>
</section>
<section id="c-wrapper">
<h2>C++ wrapper<a class="headerlink" href="#c-wrapper" title="Link to this heading">¶</a></h2>
<p>If you wish to enable the test functions for the FLINT <code class="docutils literal notranslate"><span class="pre">C++</span></code> wrapper
<code class="docutils literal notranslate"><span class="pre">flintxx</span></code> you must pass <code class="docutils literal notranslate"><span class="pre">--enable-cxx</span></code> to configure.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">C++</span></code> wrapper is always available, but tests will only run if
this option is selected. It is disabled by default (<code class="docutils literal notranslate"><span class="pre">--disable-cxx</span></code>)
because some <code class="docutils literal notranslate"><span class="pre">C++</span></code> compilers internally segfault when compiling the
tests, or exhaust memory due to the complexity of the <code class="docutils literal notranslate"><span class="pre">C++</span></code> code.</p>
</section>
<section id="building-testing-installing-and-using-flint">
<h2>Building, testing, installing and using FLINT<a class="headerlink" href="#building-testing-installing-and-using-flint" title="Link to this heading">¶</a></h2>
<p>Once FLINT is configured, in the main directory of the FLINT directory
tree simply type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make
make<span class="w"> </span>check
</pre></div>
</div>
<p>GNU make or CMake is required to build FLINT. For GNU make, this is simply
<code class="docutils literal notranslate"><span class="pre">make</span></code> on Linux, Darwin, MinGW and Cygwin systems. However, on some unixes
the command is <code class="docutils literal notranslate"><span class="pre">gmake</span></code>. For CMake, this is <code class="docutils literal notranslate"><span class="pre">cmake</span></code>, which which may need
to be installed with your package manager.</p>
<p>If you wish to install FLINT with GNU make, simply type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>install
</pre></div>
</div>
<p>If you wish to install FLINT with CMake, simply type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>build<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build
cmake<span class="w"> </span>..<span class="w"> </span>-DBUILD_SHARED_LIBS<span class="o">=</span>ON
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>--target<span class="w"> </span>install
</pre></div>
</div>
<p>Now to use FLINT, simply include the appropriate header files for the FLINT
modules you wish to use in your C program.  Then compile your program,
linking against the FLINT library, GMP/MPIR, MPFR and pthreads with the
options <code class="docutils literal notranslate"><span class="pre">-lflint</span> <span class="pre">-lmpfr</span> <span class="pre">-lgmp</span> <span class="pre">-lpthread</span></code>.</p>
<p>To uninstall FLINT with GNU make, type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>uninstall
</pre></div>
</div>
<p>Note that you may have to set <code class="docutils literal notranslate"><span class="pre">LD_LIBRARY_PATH</span></code> or equivalent for your
system to let the linker know where to find these libraries. Please refer to
your system documentation for how to do this.</p>
<p>If you have any difficulties with conflicts with system headers on your
machine, you can do the following in your code:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#undef ulong</span>
<span class="cp">#define ulong ulongxx</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="c1">// other system headers</span>
<span class="cp">#undef ulong</span>
<span class="cp">#define ulong mp_limb_t</span>
</pre></div>
</div>
<p>This prevents FLINT’s definition of <code class="docutils literal notranslate"><span class="pre">ulong</span></code> interfering with your system
headers.</p>
<p>The FLINT custom make system responds to the standard commands</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make
make<span class="w"> </span>library
make<span class="w"> </span>check
make<span class="w"> </span>clean
make<span class="w"> </span>distclean
make<span class="w"> </span>install
</pre></div>
</div>
<p>If your system supports parallel builds, FLINT will build in parallel, e.g:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>-j4<span class="w"> </span>check
</pre></div>
</div>
<p>On some systems, parallel builds appear to be available but buggy.</p>
</section>
<section id="testing-a-single-module-or-file">
<h2>Testing a single module or file<a class="headerlink" href="#testing-a-single-module-or-file" title="Link to this heading">¶</a></h2>
<p>If you wish to simply check a single module of FLINT you can pass the option
<code class="docutils literal notranslate"><span class="pre">MOD=modname</span></code> to <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">check</span></code>. You can also pass a list of module names in
inverted commas, e.g:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>check<span class="w"> </span><span class="nv">MOD</span><span class="o">=</span>ulong_extras
make<span class="w"> </span>check<span class="w"> </span><span class="nv">MOD</span><span class="o">=</span><span class="s2">&quot;fft fmpz_mat&quot;</span>
</pre></div>
</div>
<p>To specify an individual test(s) for any module you can add it (or comma
separated test list) after chosen module name followed by the colon, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>check<span class="w"> </span><span class="nv">MOD</span><span class="o">=</span>ulong_extras:clog,factor,is_prime
make<span class="w"> </span>check<span class="w"> </span><span class="nv">MOD</span><span class="o">=</span><span class="s2">&quot;fft fmpz_mat:add_sub,charpoly fq_vec:add&quot;</span>
</pre></div>
</div>
</section>
<section id="assertion-checking">
<h2>Assertion checking<a class="headerlink" href="#assertion-checking" title="Link to this heading">¶</a></h2>
<p>FLINT has an assert system. If you want a debug build you can pass
<code class="docutils literal notranslate"><span class="pre">--enable-assert</span></code> to configure. However, this will slow FLINT considerably,
so asserts should not be enabled (<code class="docutils literal notranslate"><span class="pre">--disable-assert</span></code>, the default) for
deployment.</p>
</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading">¶</a></h2>
<p>When FLINT encounters a problem, mostly illegal input, it currently aborts.
There is an experimental interface for generating proper exceptions
<code class="docutils literal notranslate"><span class="pre">flint_throw</span></code>, but this is currently rarely used and experimental - you
should expect this to change.</p>
<p>At the end, all of FLINT’s exceptions call <code class="docutils literal notranslate"><span class="pre">abort()</span></code> to terminate
the program. Using <code class="docutils literal notranslate"><span class="pre">flint_set_abort(void</span> <span class="pre">(*abort_func)(void))</span></code>, the
user can install a function that will be called instead. Similar
to the exceptions, this should be regarded as experimental.</p>
</section>
<section id="building-flint2-with-microsoft-visual-studio-using-solution-files">
<h2>Building FLINT2 with Microsoft Visual Studio using solution files<a class="headerlink" href="#building-flint2-with-microsoft-visual-studio-using-solution-files" title="Link to this heading">¶</a></h2>
<p>Brian Gladman has kindly provided the build scripts for building
Flint with Microsoft Visual Studio.</p>
<p>Building FLINT2 with Microsoft Visual Studio requires
Visual Studio 2015 Community (or higher version) and:</p>
<ul class="simple">
<li><p>an installed version of Python 3</p></li>
<li><p>an installed version of Python Tools for Visual Studio
&lt;<a class="reference external" href="https://github.com/Microsoft/PTVS">https://github.com/Microsoft/PTVS</a>&gt;</p></li>
</ul>
<p>Obtain FLINT2 by cloning it using GIT from Brian Gladman’s repository:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">git&#64;github.com:BrianGladman/flint.git</span></code></p>
</div></blockquote>
<p>FLINT2 depends on the MPIR, MPFR and PTHREADS libraries that have
to be installed and built using Visual Studio before FLINT2 can
be built.  The application directories are assumed to be in the
same root directory with the names and layouts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mpir</span>
   <span class="n">lib</span>
   <span class="n">dll</span>
<span class="n">mpfr</span>
   <span class="n">lib</span>
   <span class="n">dll</span>
<span class="n">pthreads</span>
   <span class="n">lib</span>
   <span class="n">dll</span>
<span class="n">flint</span>
   <span class="n">build</span><span class="o">.</span><span class="n">vc</span>
   <span class="n">lib</span>
   <span class="n">dll</span>
</pre></div>
</div>
<p>Here the <code class="docutils literal notranslate"><span class="pre">lib</span></code> and <code class="docutils literal notranslate"><span class="pre">dll</span></code> sub-directories for each application hold
the  static and dynamic link library outputs which will be used when
Flint is built.  They each contain up to four sub-directories for
the normal configurations for building on Windows:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Win32\Release</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Win32\Debug</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">x64\Release</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">x64\Debug</span></code></p>
</div></blockquote>
<p>To build FLINT2 for a particular configuration requires that each of the
three libraries on which FLINT2 depends must have been previously built
for the same configuration.</p>
<p>Opening the solution file <code class="docutils literal notranslate"><span class="pre">flint\build.vc\flint.sln</span></code> provides the
following build projects:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">flint_config</span></code>  - a Python program for creating the Visual Studio build files</p>
<p><code class="docutils literal notranslate"><span class="pre">build_tests</span></code>   - a Python program for building the FLINT2 tests (after they have been created)</p>
<p><code class="docutils literal notranslate"><span class="pre">run_tests</span></code>     - a Python program for running the FLINT2 tests (after they have been built)</p>
</div></blockquote>
<p>The first step in building FLINT2 is to generate the Visual Studio build
files for the version of Visual Studio being used. This is done by
running the Python application <code class="docutils literal notranslate"><span class="pre">flint_config.py</span></code>, either from within
Visual Studio or on the command line. It is run with a single input
parameter which is the last two digits of the Visual Studio version
selected for building FLINT2 (the default is 19 if no input is given).</p>
<p>This creates a build directory in the Flint root directory, for
example:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">flint\build.vs19</span></code></p>
</div></blockquote>
<p>that contains the file <code class="docutils literal notranslate"><span class="pre">flint.sln</span></code> which can now be loaded into
Visual Studio and used to build the FLINT2 library.</p>
<p>Once the FLINT2 library has been built, the FLINT2 tests can now be
built and run by returning to the Visual Studio solution:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">flint\build.vc\flint.sln</span></code></p>
</div></blockquote>
<p>and running the <code class="docutils literal notranslate"><span class="pre">build_tests</span></code> and <code class="docutils literal notranslate"><span class="pre">run_tests</span></code> Python applications.</p>
<p>After building FLINT2, the libraries and the header files that
you need to use FLINT2 are placed in the directories:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lib\&lt;Win32|x64&gt;\&lt;Debug|Release&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dll\&lt;Win32|x64&gt;\&lt;Debug|Release&gt;</span></code></p></li>
</ul>
<p>depending on the version(s) that have been built.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#"><strong>Configuring and building</strong></a><ul>
<li><a class="reference internal" href="#configuring-flint">Configuring Flint</a></li>
<li><a class="reference internal" href="#tls-reentrancy-and-single-mode">TLS, reentrancy and single mode</a></li>
<li><a class="reference internal" href="#abi-and-architecture-support">ABI and architecture support</a></li>
<li><a class="reference internal" href="#c-wrapper">C++ wrapper</a></li>
<li><a class="reference internal" href="#building-testing-installing-and-using-flint">Building, testing, installing and using FLINT</a></li>
<li><a class="reference internal" href="#testing-a-single-module-or-file">Testing a single module or file</a></li>
<li><a class="reference internal" href="#assertion-checking">Assertion checking</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li><a class="reference internal" href="#building-flint2-with-microsoft-visual-studio-using-solution-files">Building FLINT2 with Microsoft Visual Studio using solution files</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="introduction.html"
                          title="previous chapter"><strong>Introduction</strong></a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="bug_reporting.html"
                          title="next chapter"><strong>Bug reporting</strong></a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/building.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
<div id="sidebarbutton" title="Collapse sidebar">
<span>«</span>
</div>

      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="bug_reporting.html" title="Bug reporting"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Flint 2.9.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><strong>Configuring and building</strong></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2018, The Flint development team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>